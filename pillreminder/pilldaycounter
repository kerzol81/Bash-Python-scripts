#!/usr/bin/env bash
set -o errexit      
set -o nounset

readonly PROGNAME=$(basename $0)
readonly PROGDIR=$(readlink -m $(dirname $0))

conf="$PROGDIR/pilldays.cfg"

function createFirstConfig(){
	cat << EOF > $conf
# configfile for the first day generated by pillreminder
day=1
EOF
exit 0
}

function createNewConfig(){
			source $conf
			increaseDay
			cat << EOF > $conf
# configfile generated by pillreminder
day=$day
EOF
}

function increaseDay(){
		(( day++ ))
}

function getDay(){
	if [ ! -e $conf ]; then
		createFirstConfig
	fi
	source $conf
	if [ $day -ge 28 ];then
		createFirstConfig
	fi
}

main(){
	getDay
	createNewConfig
}

main
